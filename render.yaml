services:
  # Web Service - Evolution API
  - type: web
    name: evolution-api
    env: docker
    dockerfilePath: ./Dockerfile
    plan: free
    region: oregon
    healthCheckPath: /
    envVars:
      # Server Config
      - key: SERVER_URL
        sync: false
      - key: SERVER_PORT
        value: 8080

      # Database (PostgreSQL)
      - key: DATABASE_ENABLED
        value: true
      - key: DATABASE_PROVIDER
        value: postgresql
      - key: DATABASE_CONNECTION_URI
        fromDatabase:
          name: evolution-db
          property: connectionString
      - key: DATABASE_SAVE_DATA_INSTANCE
        value: true
      - key: DATABASE_SAVE_DATA_NEW_MESSAGE
        value: true
      - key: DATABASE_SAVE_MESSAGE_UPDATE
        value: true
      - key: DATABASE_SAVE_DATA_CONTACTS
        value: true
      - key: DATABASE_SAVE_DATA_CHATS
        value: true

      # Authentication
      - key: AUTHENTICATION_API_KEY
        generateValue: true
      - key: AUTHENTICATION_EXPOSE_IN_FETCH_INSTANCES
        value: true

      # CORS
      - key: CORS_ORIGIN
        value: "*"
      - key: CORS_METHODS
        value: GET,POST,PUT,DELETE
      - key: CORS_CREDENTIALS
        value: true

      # QR Code
      - key: QRCODE_LIMIT
        value: 30
      - key: QRCODE_COLOR
        value: "#198754"

      # Websocket
      - key: WEBSOCKET_ENABLED
        value: false

      # Logs
      - key: LOG_LEVEL
        value: ERROR,WARN,DEBUG,INFO,LOG,VERBOSE,DARK,WEBHOOKS
      - key: LOG_COLOR
        value: true
      - key: LOG_BAILEYS
        value: error

      # Storage
      - key: STORE_MESSAGES
        value: true
      - key: STORE_MESSAGE_UP
        value: true
      - key: STORE_CONTACTS
        value: true
      - key: STORE_CHATS
        value: true

      # Provider
      - key: PROVIDER_ENABLED
        value: false

# Database - PostgreSQL
databases:
  - name: evolution-db
    plan: free
    databaseName: evolution
    user: evolution
